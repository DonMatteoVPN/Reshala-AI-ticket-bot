# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –°–∏—Å—Ç–µ–º—ã

## üì¶ –û–±–∑–æ—Ä

Reshala Support ‚Äî —ç—Ç–æ –º–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, —Å–æ—Å—Ç–æ—è—â–∞—è –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1.  **Frontend (React Mini App)**
    - **–†–æ–ª—å:** –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–¥–∞—à–±–æ—Ä–¥) –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –≤–Ω—É—Ç—Ä–∏ Telegram.
    - **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** React, Tailwind CSS, Lucide React.
    - **–†–∞–±–æ—Ç–∞:** Nginx —Ä–∞–∑–¥–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –±–∏–ª–¥–∞.
    - **–ü–æ—Ä—Ç:** –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Ä—Ç `3000`.

2.  **Backend (FastAPI)**
    - **–†–æ–ª—å:** –Ø–¥—Ä–æ –ª–æ–≥–∏–∫–∏, API, —Ä–∞–±–æ—Ç–∞ —Å –ë–î, –æ–±—Ä–∞–±–æ—Ç–∫–∞ Telegram –±–æ—Ç–∞.
    - **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python, FastAPI, Motor (Async Mongo), python-telegram-bot.
    - **–ü–æ—Ä—Ç:** –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Ä—Ç `8001`.
    - **–ö–ª—é—á–µ–≤—ã–µ –°–µ—Ä–≤–∏—Å—ã:**
        - `TicketService`: –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤.
        - `AIProviderManager`: –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤.
        - `Bot`: Polling –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π Telegram.

3.  **–ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö (MongoDB)**
    - **–†–æ–ª—å:** –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö.
    - **–ö–æ–ª–ª–µ–∫—Ü–∏–∏:**
        - `tickets`: –¢–∏–∫–µ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏.
        - `users`: –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç.
        - `settings`: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã.
        - `ai_providers`: API –∫–ª—é—á–∏ –∏ –º–æ–¥–µ–ª–∏ AI.
        - `knowledge_base`: –°—Ç–∞—Ç—å–∏ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π.

4.  **Reverse Proxy (Nginx)**
    - **–†–æ–ª—å:** –í–Ω–µ—à–Ω—è—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, SSL, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è.
    - **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç `/api` –Ω–∞ Backend, –∞ `/` –Ω–∞ Frontend.

## üîÑ –ü–æ—Ç–æ–∫–∏ –î–∞–Ω–Ω—ã—Ö (Data Flow)

1.  **–°–æ–æ–±—â–µ–Ω–∏–µ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
    - –Æ–∑–µ—Ä –ø–∏—à–µ—Ç –±–æ—Ç—É -> –ë—ç–∫–µ–Ω–¥ –ø–æ–ª—É—á–∞–µ—Ç update.
    - –ë—ç–∫–µ–Ω–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ –∞–∫—Ç–∏–≤–Ω—ã–π —Ç–∏–∫–µ—Ç.
    - **–ï—Å–ª–∏ –µ—Å—Ç—å:** –°–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ç–∏–∫–µ—Ç.
    - **–ï—Å–ª–∏ –Ω–µ—Ç:** AI –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å (RAG –ø–æ –ë–∞–∑–µ –ó–Ω–∞–Ω–∏–π) -> –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç.
    - **–û—Ç–∫–∞–∑ AI/–≠—Å–∫–∞–ª–∞—Ü–∏—è:** –°–æ–∑–¥–∞–µ—Ç—Å—è —Ç–∏–∫–µ—Ç —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `escalated`.

2.  **–î–µ–π—Å—Ç–≤–∏—è –ú–µ–Ω–µ–¥–∂–µ—Ä–∞ (Mini App):**
    - –ú–µ–Ω–µ–¥–∂–µ—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Mini App -> –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è Frontend.
    - Frontend –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `Telegram WebApp Data`.
    - Frontend –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç–∏–∫–µ—Ç—ã (`escalated`) —á–µ—Ä–µ–∑ API.
    - –ú–µ–Ω–µ–¥–∂–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç -> –ë—ç–∫–µ–Ω–¥ —à–ª–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —é–∑–µ—Ä—É —á–µ—Ä–µ–∑ Bot API.

3.  **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
    - **Remnawave:** –ë—ç–∫–µ–Ω–¥ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç API –ü–∞–Ω–µ–ª–∏ (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –ø–æ–¥–ø–∏—Å–∫–∞).
    - **Bedolaga:** –ë—ç–∫–µ–Ω–¥ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç API –ë–∏–ª–ª–∏–Ω–≥–∞ (–±–∞–ª–∞–Ω—Å, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏).
    - **AI Providers:** –ë—ç–∫–µ–Ω–¥ —Ä–æ—Ç–∏—Ä—É–µ—Ç –∫–ª—é—á–∏ (OpenAI, Anthropic –∏ —Ç.–¥.) –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö.

## üõ†Ô∏è Docker –ö–æ–º–ø–æ–∑–∏—Ü–∏—è

```yaml
services:
  mongodb:
    image: mongo:latest
    volumes:
      - mongodb_data:/data/db

  backend:
    build: ./backend
    depends_on:
      - mongodb
    env_file: .env

  frontend:
    build: ./frontend
    args:
      - REACT_APP_BACKEND_URL=${REACT_APP_BACKEND_URL}
    ports:
      - "3000:80"
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **Mini App Auth:** Middleware `verify_telegram_auth` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å `initData` –æ—Ç Telegram –∫–ª—é—á–æ–º –±–æ—Ç–∞.
- **–ó–∞—â–∏—Ç–∞ API:** Rate limiting (–ª–∏–º–∏—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤) –Ω–∞ –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö.
- **–û–∫—Ä—É–∂–µ–Ω–∏–µ:** –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ç–æ–∫–µ–Ω—ã, mongo url) –≤ `.env`.
